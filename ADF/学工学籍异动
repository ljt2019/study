SELECT xgyd.XJYDID,
       xgyd.XSID,
       XsxxglXsjbxx.XH,
       XsxxglXsjbxx.XM,
       XsxxglXsjbxx.XSDQZT,
       xgyd.YDLBM,
       xgyd.YDRQ,
       xgyd.YDYYM,    
       xgyd.YDSM,
       xgyd.YNJ,
       xgyd.YDWH,       
       xgyd.YBJH,       
       xgyd.YXZ,
       xgyd.ZNJ,
       xgyd.XDWH,      
       xgyd.YZYFXM,       
       xgyd.XZYFXM,      
       xgyd.XBJH,       
       xgyd.ZXZ,
       xgyd.SQRXM,
       xgyd.SQSJ,       
       xgyd.SPZT,
       xgyd.SPRQ,      
       xgyd.XSZXZT,
       xgyd.XN,
       xgyd.XQ,
       XtglJxdmjXqdm.Mc,
       xgyd.ydhdqzt,
       
       XtglXn.Xnmc   AS YDXN1,
       XjglXsdmjXjydlbdm.Mc AS YDLBMC,
       (CASE xgyd.SPZT WHEN '0' then '保存' when '1' then '已提交审批' when '8' then '审批不通过' when '9' then '审批通过' end) SPZT1,       
       XjglXsdmjXjydyydm.Mc  AS YDYYM1,
       XtglDwjbsjzl1.Dwmc    AS YDWH1,
       XtglBjsjzl1.Bjmc     AS YBJH1,
       XtglDwjbsjzl.Dwmc    AS XDWH1,
       XtglZyfxxxsjzl1.Zyfxmc  AS YZYFXM1,
       XtglZyfxxxsjzl.Zyfxmc  AS XZYFXM1,
       XtglBjsjzl.Bjmc     AS XBJH1,
       XsxxglXsjbxx.sfzjh

  FROM XGXSXXGL_XJYD         xgyd,
       XSXXGL_XSJBXX       XsxxglXsjbxx,
       XJGL_XSDMJ_XJYDLBDM XjglXsdmjXjydlbdm,
       Xtgl_Xn             XtglXn,
       XTGL_JXDMJ_XQDM     XtglJxdmjXqdm,
       XJGL_XSDMJ_XJYDYYDM XjglXsdmjXjydyydm,
       XTGL_DWJBSJZL       XtglDwjbsjzl,
       XTGL_ZYFXXXSJZL     XtglZyfxxxsjzl,
       XTGL_BJSJZL         XtglBjsjzl,
       XTGL_DWJBSJZL       XtglDwjbsjzl1,
       XTGL_ZYFXXXSJZL     XtglZyfxxxsjzl1,
       XTGL_BJSJZL         XtglBjsjzl1
 WHERE xgyd.XSID = XsxxglXsjbxx.xsid(+)
   and xgyd.Ydlbm = XjglXsdmjXjydlbdm.Dm
   and xgyd.XN = XtglXn.Xnzj(+)
   and xgyd.XQ = XtglJxdmjXqdm.Dm(+)
   AND xgyd.YDYYM = XjglXsdmjXjydyydm.Dm(+)
   and xgyd.XDWH = XtglDwjbsjzl.Dwdm(+)
   and xgyd.XZYFXM = XtglZyfxxxsjzl.Zyfxdm(+)
   and xgyd.XBJH = XtglBjsjzl.Bjdm(+)
   and xgyd.YDWH = XtglDwjbsjzl1.Dwdm(+)
   and xgyd.YZYFXM = XtglZyfxxxsjzl1.Zyfxdm(+)
   and xgyd.YBJH = XtglBjsjzl1.Bjdm(+)
   AND (xgyd.YDWH IN
    (SELECT b.ssdw FROM xtgl_group b 
START WITH b.zbh IN (SELECT a.zbh FROM xtgl_usergroup a WHERE a.yhbh=:v_dlrzh)
CONNECT BY PRIOR b.zbh=b.sszbh)
 OR EXISTS (SELECT 1 FROM XSXXGL_XSJBXX WHERE XH = :v_dlrzh))